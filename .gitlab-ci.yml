stages:
  - build
  - deploy

stg-build:
  stage: build
  variables:
    GIT_STRATEGY: clone
  tags:
    - build
  only:
    - staging
  script:
    - docker build . -t website-builder:$CI_PIPELINE_ID
    - docker run --rm -v $PWD/dist:/app/dist:rw website-builder:$CI_PIPELINE_ID
    - docker rmi website-builder:$CI_PIPELINE_ID

stg-deploy:
  stage: deploy
  tags:
    - deploy
  only:
    - staging
  script:
    - rm -rf /var/www/stg-root/*
    - cp -r dist/ceit94/* /var/www/stg-root/
